<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar System Explorer - Interactive Educational Simulation</title>
    <style>
        :root {
            --primary-green: #00ff00;
            --primary-cyan: #00ffff;
            --primary-yellow: #ffff00;
            --bg-dark: #000011;
            --panel-bg: rgba(0, 0, 0, 0.85);
            --border-glow: 0 0 10px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: var(--bg-dark);
            color: var(--primary-green);
            overflow: hidden;
            cursor: grab;
            user-select: none;
        }

        body:active {
            cursor: grabbing;
        }

        #container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }

        .ui-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            background: var(--panel-bg);
            border: 2px solid var(--primary-green);
            padding: 15px;
            border-radius: 10px;
            z-index: 100;
            backdrop-filter: blur(10px);
            min-width: 280px;
            box-shadow: var(--border-glow) var(--primary-green);
        }

        .ui-panel h3 {
            color: var(--primary-cyan);
            margin-bottom: 10px;
            text-shadow: var(--border-glow) currentColor;
            font-size: 16px;
        }

        .home-btn {
    position: absolute;
    top: 20px;
    right: 350px;
    background: var(--panel-bg);
    border: 2px solid var(--primary-yellow);
    color: var(--primary-yellow);
    padding: 10px 15px;
    border-radius: 8px;
    cursor: pointer;
    font-family: inherit;
    font-size: 12px;
    text-decoration: none;
    display: flex;
    align-items: center;
    gap: 5px;
    z-index: 100;
    backdrop-filter: blur(10px);
    box-shadow: var(--border-glow) var(--primary-yellow);
    transition: all 0.3s;
}

.home-btn:hover {
    background: rgba(255, 255, 0, 0.1);
    transform: translateY(-2px);
}

.home-btn:active {
    transform: translateY(0);
}

        .control-group {
            margin-bottom: 15px;
        }

        .control-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 12px;
            color: var(--primary-green);
        }

        .slider {
            width: 100%;
            height: 6px;
            background: #333;
            outline: none;
            border-radius: 3px;
            transition: all 0.3s;
        }

        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 16px;
            height: 16px;
            background: var(--primary-green);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: var(--border-glow) var(--primary-green);
            transition: all 0.3s;
        }

        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }

        .button {
            background: transparent;
            border: 1px solid var(--primary-green);
            color: var(--primary-green);
            padding: 8px 12px;
            margin: 3px;
            cursor: pointer;
            border-radius: 5px;
            font-family: inherit;
            font-size: 11px;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .button:hover {
            background: rgba(0, 255, 0, 0.1);
            box-shadow: var(--border-glow) var(--primary-green);
            transform: translateY(-2px);
        }

        .button:active {
            transform: translateY(0);
        }

        .button.active {
            background: rgba(0, 255, 0, 0.2);
            box-shadow: inset var(--border-glow) var(--primary-green);
        }

        .button-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 5px;
            margin-top: 10px;
        }

        .info-panel {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: var(--panel-bg);
            border: 2px solid var(--primary-cyan);
            padding: 15px;
            border-radius: 10px;
            z-index: 100;
            backdrop-filter: blur(10px);
            max-width: 320px;
            box-shadow: var(--border-glow) var(--primary-cyan);
            transition: all 0.3s;
        }

        .planet-info {
            display: none;
            animation: fadeIn 0.3s ease-in;
        }

        .planet-info.active {
            display: block;
        }

        .planet-info h4 {
            color: var(--primary-yellow);
            margin-bottom: 10px;
            font-size: 18px;
            text-shadow: var(--border-glow) currentColor;
        }

        .planet-info p {
            margin-bottom: 6px;
            font-size: 12px;
            line-height: 1.5;
        }

        .planet-info .fact {
            color: var(--primary-cyan);
            font-style: italic;
            margin-top: 8px;
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--primary-green);
            font-size: 20px;
            z-index: 1000;
            text-align: center;
        }

        .loading::after {
            content: '';
            animation: dots 1.5s infinite;
        }

        .stats {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--panel-bg);
            border: 1px solid var(--primary-yellow);
            padding: 12px;
            border-radius: 8px;
            font-size: 11px;
            box-shadow: var(--border-glow) var(--primary-yellow);
        }

        .instructions {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--panel-bg);
            border: 2px solid var(--primary-cyan);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            z-index: 1000;
            max-width: 400px;
            box-shadow: var(--border-glow) var(--primary-cyan);
        }

        .instructions h3 {
            color: var(--primary-cyan);
            margin-bottom: 15px;
            font-size: 18px;
        }

        .instructions p {
            margin-bottom: 10px;
            font-size: 13px;
            line-height: 1.4;
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            color: var(--primary-green);
            font-size: 18px;
            cursor: pointer;
            padding: 5px;
        }

        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: var(--primary-green);
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 1001;
            pointer-events: none;
            border: 1px solid var(--primary-green);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .tooltip.show {
            opacity: 1;
        }

        .comparison-mode {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: var(--panel-bg);
            border: 2px solid var(--primary-yellow);
            padding: 15px;
            border-radius: 10px;
            z-index: 100;
            backdrop-filter: blur(10px);
            max-width: 300px;
            display: none;
        }

        .comparison-mode.active {
            display: block;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: #333;
            border-radius: 2px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary-green);
            width: 0%;
            transition: width 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes dots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }

        .pulsing {
            animation: pulse 2s infinite;
        }

        @keyframes planetGlow {
            0%, 100% { box-shadow: 0 0 20px currentColor; }
            50% { box-shadow: 0 0 30px currentColor; }
        }

        .planet-hover {
            animation: planetGlow 1s infinite;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .ui-panel {
                min-width: 240px;
                font-size: 11px;
            }
            
            .info-panel {
                max-width: 280px;
                bottom: 80px;
            }
            
            .button-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        .focus-visible {
            outline: 2px solid var(--primary-cyan);
            outline-offset: 2px;
        }
    </style>
</head>
<body>
    <div id="container">
    <a href="index.html" class="home-btn">
    🏠 Home
    </a>
        <div class="loading" id="loading">
            <div>Initializing Solar System</div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>
        
        <div class="instructions" id="instructions">
            <button class="close-btn" id="closeInstructions">&times;</button>
            <h3>🚀 Solar System Explorer</h3>
            <p><strong>Mouse Controls:</strong></p>
            <p>• Click and drag to orbit around the solar system</p>
            <p>• Scroll wheel to zoom in/out</p>
            <p>• Click on planets to learn more about them</p>
            <p>• Hover over planets to see their names</p>
            <p><strong>Features:</strong></p>
            <p>• Realistic orbital mechanics and scaled distances</p>
            <p>• Detailed information for all celestial bodies</p>
            <p>• Interactive controls for time speed and focus</p>
            <p>• Educational comparisons and facts</p>
            <button class="button" id="startExploration">Start Exploration</button>
        </div>
        
        <div class="ui-panel">
            <h3>🎮 Mission Control</h3>
            <div class="control-group">
                <label for="timeSpeed">Time Speed</label>
                <input type="range" class="slider" id="timeSpeed" min="0" max="10" value="1" step="0.1">
                <span id="speedValue">1.0x</span>
            </div>
            <div class="control-group">
                <label for="zoomLevel">Zoom Level</label>
                <input type="range" class="slider" id="zoomLevel" min="50" max="2000" value="800" step="25">
            </div>
            <div class="control-group">
                <button class="button" id="pauseBtn">⏸️ Pause</button>
                <button class="button" id="resetBtn">🔄 Reset</button>
                <button class="button" id="toggleOrbits">🔄 Orbits</button>
            </div>
            <div class="control-group">
                <label>Quick Focus</label>
                <div class="button-grid">
                    <button class="button" id="focusSun">☀️ Sun</button>
                    <button class="button" id="focusMercury">☿ Mercury</button>
                    <button class="button" id="focusVenus">♀ Venus</button>
                    <button class="button" id="focusEarth">🌍 Earth</button>
                    <button class="button" id="focusMars">♂ Mars</button>
                    <button class="button" id="focusJupiter">♃ Jupiter</button>
                    <button class="button" id="focusSaturn">♄ Saturn</button>
                    <button class="button" id="focusUranus">♅ Uranus</button>
                    <button class="button" id="focusNeptune">♆ Neptune</button>
                </div>
            </div>
            <div class="control-group">
                <button class="button" id="toggleComparison">📊 Compare</button>
                <button class="button" id="toggleRealistic">🔬 Realistic</button>
            </div>
        </div>

        <div class="stats">
            <div><strong>Performance</strong></div>
            <div>FPS: <span id="fps">60</span></div>
            <div>Objects: <span id="objectCount">0</span></div>
            <div>Camera: <span id="cameraPos">0, 0, 0</span></div>
        </div>

        <div class="info-panel">
            <div class="planet-info active" id="info-default">
                <h4>🌌 Solar System Explorer</h4>
                <p><strong>Welcome to our cosmic neighborhood!</strong></p>
                <p>Click on any planet to discover fascinating facts and scientific data.</p>
                <p><strong>Did you know?</strong> Light from the Sun takes about 8 minutes to reach Earth!</p>
                <p class="fact">Use the controls to explore at your own pace. The universe awaits! ✨</p>
            </div>
            
            <div class="planet-info" id="info-sun">
                <h4>☀️ The Sun</h4>
                <p><strong>Type:</strong> G-type Main Sequence Star</p>
                <p><strong>Mass:</strong> 1.989 × 10³⁰ kg (333,000 × Earth)</p>
                <p><strong>Temperature:</strong> 5,778 K (surface), 15.7 million K (core)</p>
                <p><strong>Age:</strong> ~4.6 billion years</p>
                <p><strong>Diameter:</strong> 1.39 million km (109 × Earth)</p>
                <p class="fact">The Sun contains 99.86% of the Solar System's mass and converts 4 million tons of matter into energy every second!</p>
            </div>

            <div class="planet-info" id="info-mercury">
                <h4>☿ Mercury</h4>
                <p><strong>Distance:</strong> 57.9 million km from Sun</p>
                <p><strong>Orbital Period:</strong> 88 Earth days</p>
                <p><strong>Diameter:</strong> 4,879 km (0.38 × Earth)</p>
                <p><strong>Temperature:</strong> 167°C (day), -173°C (night)</p>
                <p><strong>Moons:</strong> 0</p>
                <p><strong>Discovery:</strong> Known since ancient times</p>
                <p class="fact">Mercury has the most extreme temperature variations in the solar system due to its lack of atmosphere!</p>
            </div>

            <div class="planet-info" id="info-venus">
                <h4>♀ Venus</h4>
                <p><strong>Distance:</strong> 108.2 million km from Sun</p>
                <p><strong>Orbital Period:</strong> 225 Earth days</p>
                <p><strong>Diameter:</strong> 12,104 km (0.95 × Earth)</p>
                <p><strong>Temperature:</strong> 462°C (hottest planet)</p>
                <p><strong>Moons:</strong> 0</p>
                <p><strong>Atmosphere:</strong> 96.5% CO₂, crushing pressure</p>
                <p class="fact">Venus rotates backwards and is the hottest planet due to its runaway greenhouse effect!</p>
            </div>

            <div class="planet-info" id="info-earth">
                <h4>🌍 Earth</h4>
                <p><strong>Distance:</strong> 149.6 million km from Sun</p>
                <p><strong>Orbital Period:</strong> 365.25 days</p>
                <p><strong>Diameter:</strong> 12,756 km</p>
                <p><strong>Temperature:</strong> 15°C (average)</p>
                <p><strong>Moons:</strong> 1 (Luna)</p>
                <p><strong>Atmosphere:</strong> 78% N₂, 21% O₂</p>
                <p class="fact">Earth is the only known planet with life and liquid water on its surface. Our "Goldilocks" zone location makes life possible!</p>
            </div>

            <div class="planet-info" id="info-mars">
                <h4>♂ Mars</h4>
                <p><strong>Distance:</strong> 227.9 million km from Sun</p>
                <p><strong>Orbital Period:</strong> 687 Earth days</p>
                <p><strong>Diameter:</strong> 6,792 km (0.53 × Earth)</p>
                <p><strong>Temperature:</strong> -65°C (average)</p>
                <p><strong>Moons:</strong> 2 (Phobos, Deimos)</p>
                <p><strong>Atmosphere:</strong> 95% CO₂, very thin</p>
                <p class="fact">Mars has the largest volcano in the solar system (Olympus Mons) and evidence of ancient water flows!</p>
            </div>

            <div class="planet-info" id="info-jupiter">
                <h4>♃ Jupiter</h4>
                <p><strong>Distance:</strong> 778.5 million km from Sun</p>
                <p><strong>Orbital Period:</strong> 11.86 Earth years</p>
                <p><strong>Diameter:</strong> 142,984 km (11.2 × Earth)</p>
                <p><strong>Temperature:</strong> -110°C (cloud tops)</p>
                <p><strong>Moons:</strong> 95+ known moons</p>
                <p><strong>Composition:</strong> 90% hydrogen, 10% helium</p>
                <p class="fact">Jupiter is a failed star and acts as the solar system's vacuum cleaner, protecting inner planets from asteroids!</p>
            </div>

            <div class="planet-info" id="info-saturn">
                <h4>♄ Saturn</h4>
                <p><strong>Distance:</strong> 1.43 billion km from Sun</p>
                <p><strong>Orbital Period:</strong> 29.46 Earth years</p>
                <p><strong>Diameter:</strong> 120,536 km (9.4 × Earth)</p>
                <p><strong>Temperature:</strong> -140°C (cloud tops)</p>
                <p><strong>Moons:</strong> 146+ known moons</p>
                <p><strong>Density:</strong> 0.687 g/cm³ (less than water!)</p>
                <p class="fact">Saturn's rings are made of ice and rock particles, some as small as dust, others as large as houses!</p>
            </div>

            <div class="planet-info" id="info-uranus">
                <h4>♅ Uranus</h4>
                <p><strong>Distance:</strong> 2.87 billion km from Sun</p>
                <p><strong>Orbital Period:</strong> 84 Earth years</p>
                <p><strong>Diameter:</strong> 51,118 km (4.0 × Earth)</p>
                <p><strong>Temperature:</strong> -195°C (coldest planet)</p>
                <p><strong>Moons:</strong> 27 known moons</p>
                <p><strong>Rotation:</strong> 98° tilt (rolls on its side)</p>
                <p class="fact">Uranus rotates on its side and has seasons that last 21 Earth years! It was the first planet discovered with a telescope.</p>
            </div>

            <div class="planet-info" id="info-neptune">
                <h4>♆ Neptune</h4>
                <p><strong>Distance:</strong> 4.50 billion km from Sun</p>
                <p><strong>Orbital Period:</strong> 165 Earth years</p>
                <p><strong>Diameter:</strong> 49,528 km (3.9 × Earth)</p>
                <p><strong>Temperature:</strong> -200°C</p>
                <p><strong>Moons:</strong> 16 known moons</p>
                <p><strong>Winds:</strong> Up to 2,100 km/h (fastest in solar system)</p>
                <p class="fact">Neptune has the fastest winds in the solar system and takes 165 Earth years to complete one orbit!</p>
            </div>
        </div>

        <div class="comparison-mode" id="comparisonMode">
            <h4>🔬 Planet Comparison</h4>
            <div id="comparisonData"></div>
        </div>

        <div class="tooltip" id="tooltip"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        class SolarSystemSimulation {
            constructor() {
                this.scene = null;
                this.camera = null;
                this.renderer = null;
                this.controls = null;
                this.sun = null;
                this.planets = [];
                this.asteroidBelt = [];
                this.particleSystem = null;
                this.orbitLines = [];
                
                this.isPaused = false;
                this.showOrbits = true;
                this.timeSpeed = 1;
                this.selectedPlanet = null;
                this.frameCount = 0;
                this.lastTime = performance.now();
                this.isRealisticMode = false;
                this.isComparisonMode = false;
                
                this.mouse = new THREE.Vector2();
                this.raycaster = new THREE.Raycaster();
                this.tooltip = document.getElementById('tooltip');
                
                this.cameraControls = {
                    isMouseDown: false,
                    mouseX: 0,
                    mouseY: 0,
                    targetRotationX: 0,
                    targetRotationY: 0,
                    currentRotationX: 0,
                    currentRotationY: 0
                };

                this.CONFIG = {
                    ASTEROID_COUNT: 50,
                    PARTICLE_COUNT: 200,
                    STAR_COUNT: 500,
                    PERFORMANCE_TARGET_FPS: 60
                };

                this.planetData = [
                    {
                        name: 'Mercury',
                        distance: 40,
                        size: 1.5,
                        color: 0x8C7853,
                        speed: 0.02,
                        info: 'mercury',
                        realDistance: 57.9,
                        realSize: 4879,
                        moons: 0
                    },
                    {
                        name: 'Venus',
                        distance: 60,
                        size: 2.2,
                        color: 0xFFC649,
                        speed: 0.015,
                        info: 'venus',
                        realDistance: 108.2,
                        realSize: 12104,
                        moons: 0
                    },
                    {
                        name: 'Earth',
                        distance: 80,
                        size: 2.5,
                        color: 0x6B93D6,
                        speed: 0.01,
                        info: 'earth',
                        realDistance: 149.6,
                        realSize: 12756,
                        moons: 1
                    },
                    {
                        name: 'Mars',
                        distance: 110,
                        size: 2,
                        color: 0xCD5C5C,
                        speed: 0.008,
                        info: 'mars',
                        realDistance: 227.9,
                        realSize: 6792,
                        moons: 2
                    },
                    {
                        name: 'Jupiter',
                        distance: 180,
                        size: 8,
                        color: 0xD8CA9D,
                        speed: 0.005,
                        info: 'jupiter',
                        realDistance: 778.5,
                        realSize: 142984,
                        moons: 95
                    },
                    {
                        name: 'Saturn',
                        distance: 250,
                        size: 7,
                        color: 0xFAD5A5,
                        speed: 0.003,
                        info: 'saturn',
                        realDistance: 1432,
                        realSize: 120536,
                        moons: 146
                    },
                    {
                        name: 'Uranus',
                        distance: 320,
                        size: 4,
                        color: 0x4FD0E4,
                        speed: 0.002,
                        info: 'uranus',
                        realDistance: 2867,
                        realSize: 51118,
                        moons: 27
                    },
                    {
                        name: 'Neptune',
                        distance: 380,
                        size: 4,
                        color: 0x4B70DD,
                        speed: 0.001,
                        info: 'neptune',
                        realDistance: 4515,
                        realSize: 49528,
                        moons: 16
                    }
                ];

                this.init();
            }

            async init() {
                try {
                    this.showProgress(10);
                    this.createScene();
                    this.showProgress(20);
                    this.createCamera();
                    this.showProgress(30);
                    this.createRenderer();
                    this.showProgress(40);
                    this.createStarfield();
                    this.showProgress(50);
                    this.createSun();
                    this.showProgress(60);
                    this.createPlanets();
                    this.showProgress(70);
                    this.createAsteroidBelt();
                    this.showProgress(80);
                    this.createParticleSystem();
                    this.showProgress(90);
                    this.setupEventListeners();
                    this.showProgress(100);
                    
                    await this.delay(500);
                    this.hideLoading();
                    this.animate();
                    
                } catch (error) {
                    console.error('Initialization error:', error);
                    this.showError('Failed to initialize simulation. Please refresh the page.');
                }
            }

            showProgress(percent) {
                document.getElementById('progressFill').style.width = percent + '%';
            }

            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }

            hideLoading() {
                document.getElementById('loading').style.display = 'none';
            }

            showError(message) {
                document.getElementById('loading').innerHTML = `<div style="color: #ff0000;">${message}</div>`;
            }

            createScene() {
                this.scene = new THREE.Scene();
                this.scene.fog = new THREE.Fog(0x000011, 1000, 3000);
            }

            createCamera() {
                this.camera = new THREE.PerspectiveCamera(
                    75,
                    window.innerWidth / window.innerHeight,
                    0.1,
                    10000
                );
                this.camera.position.set(0, 100, 800);
            }

            createRenderer() {
                this.renderer = new THREE.WebGLRenderer({
                    antialias: true,
                    alpha: true,
                    powerPreference: "high-performance"
                });
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                this.renderer.setClearColor(0x000011);
                this.renderer.shadowMap.enabled = true;
                this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;
                this.renderer.outputEncoding = THREE.sRGBEncoding;
                this.renderer.toneMapping = THREE.ACESFilmicToneMapping;
                this.renderer.toneMappingExposure = 1.2;
                
                document.getElementById('container').appendChild(this.renderer.domElement);
            }

            createStarfield() {
                const starGeometry = new THREE.BufferGeometry();
                const starMaterial = new THREE.PointsMaterial({
                    color: 0xFFFFFF,
                    size: 2,
                    transparent: true,
                    opacity: 0.8
                });

                const starVertices = [];
                const starColors = [];
                
                for (let i = 0; i < this.CONFIG.STAR_COUNT; i++) {
                    const x = (Math.random() - 0.5) * 6000;
                    const y = (Math.random() - 0.5) * 6000;
                    const z = (Math.random() - 0.5) * 6000;
                    starVertices.push(x, y, z);
                    
                    const color = new THREE.Color();
                    color.setHSL(Math.random() * 0.3 + 0.5, 0.5, 0.5 + Math.random() * 0.5);
                    starColors.push(color.r, color.g, color.b);
                    }
                
                starGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starVertices, 3));
                starGeometry.setAttribute('color', new THREE.Float32BufferAttribute(starColors, 3));
                
                const stars = new THREE.Points(starGeometry, starMaterial);
                this.scene.add(stars);
            }

            createSun() {
                const sunGeometry = new THREE.SphereGeometry(15, 32, 32);
                const sunMaterial = new THREE.MeshBasicMaterial({
                    color: 0xFFFF00,
                    emissive: 0xFFAA00,
                    emissiveIntensity: 0.5
                });
                
                this.sun = new THREE.Mesh(sunGeometry, sunMaterial);
                this.sun.name = 'Sun';
                this.sun.userData = { type: 'sun', info: 'sun' };
                this.scene.add(this.sun);
                
                // Add sun light
                const sunLight = new THREE.PointLight(0xFFFFAA, 2, 2000);
                sunLight.position.set(0, 0, 0);
                sunLight.castShadow = true;
                sunLight.shadow.mapSize.width = 2048;
                sunLight.shadow.mapSize.height = 2048;
                this.scene.add(sunLight);
                
                // Add ambient light
                const ambientLight = new THREE.AmbientLight(0x404040, 0.1);
                this.scene.add(ambientLight);
            }

            createPlanets() {
                this.planetData.forEach((data, index) => {
                    const planet = this.createPlanet(data);
                    this.planets.push(planet);
                    this.scene.add(planet);
                    
                    // Create orbit line
                    if (this.showOrbits) {
                        const orbitGeometry = new THREE.RingGeometry(data.distance - 0.5, data.distance + 0.5, 64);
                        const orbitMaterial = new THREE.MeshBasicMaterial({
                            color: 0x444444,
                            side: THREE.DoubleSide,
                            transparent: true,
                            opacity: 0.3
                        });
                        const orbit = new THREE.Mesh(orbitGeometry, orbitMaterial);
                        orbit.rotation.x = -Math.PI / 2;
                        orbit.userData = { type: 'orbit' };
                        this.orbitLines.push(orbit);
                        this.scene.add(orbit);
                    }
                });
            }

            createPlanet(data) {
                const geometry = new THREE.SphereGeometry(data.size, 32, 32);
                const material = new THREE.MeshPhongMaterial({
                    color: data.color,
                    shininess: 30
                });
                
                const planet = new THREE.Mesh(geometry, material);
                planet.name = data.name;
                planet.userData = {
                    type: 'planet',
                    info: data.info,
                    distance: data.distance,
                    speed: data.speed,
                    angle: Math.random() * Math.PI * 2,
                    originalColor: data.color,
                    realData: {
                        distance: data.realDistance,
                        size: data.realSize,
                        moons: data.moons
                    }
                };
                
                planet.position.set(data.distance, 0, 0);
                planet.castShadow = true;
                planet.receiveShadow = true;
                
                // Add special effects for certain planets
                if (data.name === 'Saturn') {
                    this.addSaturnRings(planet);
                } else if (data.name === 'Earth') {
                    this.addEarthMoon(planet);
                }
                
                return planet;
            }

            addSaturnRings(saturn) {
                const ringGeometry = new THREE.RingGeometry(saturn.userData.distance * 0.15, saturn.userData.distance * 0.25, 32);
                const ringMaterial = new THREE.MeshBasicMaterial({
                    color: 0xAAAAA0,
                    side: THREE.DoubleSide,
                    transparent: true,
                    opacity: 0.6
                });
                const rings = new THREE.Mesh(ringGeometry, ringMaterial);
                rings.rotation.x = -Math.PI / 2;
                rings.rotation.z = 0.1;
                saturn.add(rings);
            }

            addEarthMoon(earth) {
                const moonGeometry = new THREE.SphereGeometry(0.5, 16, 16);
                const moonMaterial = new THREE.MeshPhongMaterial({
                    color: 0xCCCCCC
                });
                const moon = new THREE.Mesh(moonGeometry, moonMaterial);
                moon.position.set(8, 0, 0);
                moon.userData = { type: 'moon', speed: 0.05 };
                earth.add(moon);
            }

            createAsteroidBelt() {
                const asteroidBeltDistance = 145;
                for (let i = 0; i < this.CONFIG.ASTEROID_COUNT; i++) {
                    const asteroid = this.createAsteroid(asteroidBeltDistance);
                    this.asteroidBelt.push(asteroid);
                    this.scene.add(asteroid);
                }
            }

            createAsteroid(baseDistance) {
                const size = Math.random() * 0.5 + 0.2;
                const geometry = new THREE.SphereGeometry(size, 6, 6);
                const material = new THREE.MeshPhongMaterial({
                    color: 0x666666
                });
                
                const asteroid = new THREE.Mesh(geometry, material);
                const distance = baseDistance + (Math.random() - 0.5) * 30;
                const angle = Math.random() * Math.PI * 2;
                
                asteroid.position.set(
                    Math.cos(angle) * distance,
                    (Math.random() - 0.5) * 10,
                    Math.sin(angle) * distance
                );
                
                asteroid.userData = {
                    type: 'asteroid',
                    angle: angle,
                    distance: distance,
                    speed: Math.random() * 0.001 + 0.0005
                };
                
                return asteroid;
            }

            createParticleSystem() {
                const particleGeometry = new THREE.BufferGeometry();
                const particleVertices = [];
                const particleColors = [];
                
                for (let i = 0; i < this.CONFIG.PARTICLE_COUNT; i++) {
                    const x = (Math.random() - 0.5) * 2000;
                    const y = (Math.random() - 0.5) * 2000;
                    const z = (Math.random() - 0.5) * 2000;
                    particleVertices.push(x, y, z);
                    
                    const color = new THREE.Color();
                    color.setHSL(Math.random(), 0.5, 0.5);
                    particleColors.push(color.r, color.g, color.b);
                }
                
                particleGeometry.setAttribute('position', new THREE.Float32BufferAttribute(particleVertices, 3));
                particleGeometry.setAttribute('color', new THREE.Float32BufferAttribute(particleColors, 3));
                
                const particleMaterial = new THREE.PointsMaterial({
                    size: 1,
                    transparent: true,
                    opacity: 0.6,
                    vertexColors: true
                });
                
                this.particleSystem = new THREE.Points(particleGeometry, particleMaterial);
                this.scene.add(this.particleSystem);
            }

            setupEventListeners() {
                // Window resize
                window.addEventListener('resize', this.onWindowResize.bind(this));
                
                // Mouse events
                this.renderer.domElement.addEventListener('mousemove', this.onMouseMove.bind(this));
                this.renderer.domElement.addEventListener('mousedown', this.onMouseDown.bind(this));
                this.renderer.domElement.addEventListener('mouseup', this.onMouseUp.bind(this));
                this.renderer.domElement.addEventListener('wheel', this.onMouseWheel.bind(this));
                this.renderer.domElement.addEventListener('click', this.onMouseClick.bind(this));
                
                // Touch events for mobile
                this.renderer.domElement.addEventListener('touchstart', this.onTouchStart.bind(this));
                this.renderer.domElement.addEventListener('touchmove', this.onTouchMove.bind(this));
                this.renderer.domElement.addEventListener('touchend', this.onTouchEnd.bind(this));
                
                // UI Controls
                document.getElementById('timeSpeed').addEventListener('input', this.onTimeSpeedChange.bind(this));
                document.getElementById('zoomLevel').addEventListener('input', this.onZoomChange.bind(this));
                document.getElementById('pauseBtn').addEventListener('click', this.togglePause.bind(this));
                document.getElementById('resetBtn').addEventListener('click', this.resetSimulation.bind(this));
                document.getElementById('toggleOrbits').addEventListener('click', this.toggleOrbits.bind(this));
                document.getElementById('toggleComparison').addEventListener('click', this.toggleComparison.bind(this));
                document.getElementById('toggleRealistic').addEventListener('click', this.toggleRealistic.bind(this));
                
                // Planet focus buttons
                document.getElementById('focusSun').addEventListener('click', () => this.focusOnObject('Sun'));
                document.getElementById('focusMercury').addEventListener('click', () => this.focusOnObject('Mercury'));
                document.getElementById('focusVenus').addEventListener('click', () => this.focusOnObject('Venus'));
                document.getElementById('focusEarth').addEventListener('click', () => this.focusOnObject('Earth'));
                document.getElementById('focusMars').addEventListener('click', () => this.focusOnObject('Mars'));
                document.getElementById('focusJupiter').addEventListener('click', () => this.focusOnObject('Jupiter'));
                document.getElementById('focusSaturn').addEventListener('click', () => this.focusOnObject('Saturn'));
                document.getElementById('focusUranus').addEventListener('click', () => this.focusOnObject('Uranus'));
                document.getElementById('focusNeptune').addEventListener('click', () => this.focusOnObject('Neptune'));
                
                // Instructions
                document.getElementById('closeInstructions').addEventListener('click', this.closeInstructions.bind(this));
                document.getElementById('startExploration').addEventListener('click', this.closeInstructions.bind(this));
                
                // Keyboard controls
                document.addEventListener('keydown', this.onKeyDown.bind(this));
            }

            onWindowResize() {
                this.camera.aspect = window.innerWidth / window.innerHeight;
                this.camera.updateProjectionMatrix();
                this.renderer.setSize(window.innerWidth, window.innerHeight);
            }

            onMouseMove(event) {
                // Update mouse position for raycasting
                this.mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
                this.mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
                
                // Handle camera rotation
                if (this.cameraControls.isMouseDown) {
                    const deltaX = event.clientX - this.cameraControls.mouseX;
                    const deltaY = event.clientY - this.cameraControls.mouseY;
                    
                    this.cameraControls.targetRotationY += deltaX * 0.01;
                    this.cameraControls.targetRotationX += deltaY * 0.01;
                    
                    this.cameraControls.mouseX = event.clientX;
                    this.cameraControls.mouseY = event.clientY;
                }
                
                // Handle hover effects
                this.handleHover();
            }

            onMouseDown(event) {
                this.cameraControls.isMouseDown = true;
                this.cameraControls.mouseX = event.clientX;
                this.cameraControls.mouseY = event.clientY;
                document.body.style.cursor = 'grabbing';
            }

            onMouseUp(event) {
                this.cameraControls.isMouseDown = false;
                document.body.style.cursor = 'grab';
            }

            onMouseWheel(event) {
                event.preventDefault();
                const zoomSlider = document.getElementById('zoomLevel');
                const currentZoom = parseFloat(zoomSlider.value);
                const zoomDelta = event.deltaY > 0 ? -50 : 50;
                const newZoom = Math.max(50, Math.min(2000, currentZoom + zoomDelta));
                
                zoomSlider.value = newZoom;
                this.onZoomChange();
            }

            onMouseClick(event) {
                this.raycaster.setFromCamera(this.mouse, this.camera);
                const intersects = this.raycaster.intersectObjects([this.sun, ...this.planets]);
                
                if (intersects.length > 0) {
                    const object = intersects[0].object;
                    if (object.userData.type === 'planet' || object.userData.type === 'sun') {
                        this.selectPlanet(object);
                    }
                }
            }

            onTouchStart(event) {
                if (event.touches.length === 1) {
                    const touch = event.touches[0];
                    this.cameraControls.isMouseDown = true;
                    this.cameraControls.mouseX = touch.clientX;
                    this.cameraControls.mouseY = touch.clientY;
                }
            }

            onTouchMove(event) {
                if (event.touches.length === 1 && this.cameraControls.isMouseDown) {
                    const touch = event.touches[0];
                    const deltaX = touch.clientX - this.cameraControls.mouseX;
                    const deltaY = touch.clientY - this.cameraControls.mouseY;
                    
                    this.cameraControls.targetRotationY += deltaX * 0.01;
                    this.cameraControls.targetRotationX += deltaY * 0.01;
                    
                    this.cameraControls.mouseX = touch.clientX;
                    this.cameraControls.mouseY = touch.clientY;
                }
            }

            onTouchEnd(event) {
                this.cameraControls.isMouseDown = false;
            }

            onKeyDown(event) {
                switch (event.key) {
                    case ' ':
                        event.preventDefault();
                        this.togglePause();
                        break;
                    case 'r':
                        this.resetSimulation();
                        break;
                    case 'o':
                        this.toggleOrbits();
                        break;
                    case '1':
                        this.focusOnObject('Sun');
                        break;
                    case '2':
                        this.focusOnObject('Mercury');
                        break;
                    case '3':
                        this.focusOnObject('Venus');
                        break;
                    case '4':
                        this.focusOnObject('Earth');
                        break;
                    case '5':
                        this.focusOnObject('Mars');
                        break;
                    case '6':
                        this.focusOnObject('Jupiter');
                        break;
                    case '7':
                        this.focusOnObject('Saturn');
                        break;
                    case '8':
                        this.focusOnObject('Uranus');
                        break;
                    case '9':
                        this.focusOnObject('Neptune');
                        break;
                }
            }

            handleHover() {
                this.raycaster.setFromCamera(this.mouse, this.camera);
                const intersects = this.raycaster.intersectObjects([this.sun, ...this.planets]);
                
                // Clear previous hover effects
                this.planets.forEach(planet => {
                    planet.material.emissive.setHex(0x000000);
                });
                this.sun.material.emissiveIntensity = 0.5;
                
                if (intersects.length > 0) {
                    const object = intersects[0].object;
                    if (object.userData.type === 'planet' || object.userData.type === 'sun') {
                        // Add hover effect
                        if (object.userData.type === 'planet') {
                            object.material.emissive.setHex(0x222222);
                        } else {
                            object.material.emissiveIntensity = 0.8;
                        }
                        
                        // Show tooltip
                        this.showTooltip(object.name, event.clientX, event.clientY);
                        document.body.style.cursor = 'pointer';
                    } else {
                        this.hideTooltip();
                        document.body.style.cursor = 'grab';
                    }
                } else {
                    this.hideTooltip();
                    document.body.style.cursor = 'grab';
                }
            }

            showTooltip(text, x, y) {
                const tooltip = document.getElementById('tooltip');
                tooltip.textContent = text;
                tooltip.style.left = x + 10 + 'px';
                tooltip.style.top = y - 10 + 'px';
                tooltip.classList.add('show');
            }

            hideTooltip() {
                document.getElementById('tooltip').classList.remove('show');
            }

            selectPlanet(object) {
                // Clear previous selection
                this.planets.forEach(planet => {
                    planet.material.emissive.setHex(0x000000);
                });
                this.sun.material.emissiveIntensity = 0.5;
                
                // Highlight selected object
                if (object.userData.type === 'planet') {
                    object.material.emissive.setHex(0x444444);
                } else {
                    object.material.emissiveIntensity = 1.0;
                }
                
                this.selectedPlanet = object;
                this.showPlanetInfo(object.userData.info);
                this.focusOnObject(object.name);
            }

            showPlanetInfo(infoType) {
                // Hide all info panels
                document.querySelectorAll('.planet-info').forEach(panel => {
                    panel.classList.remove('active');
                });
                
                // Show selected info panel
                const infoPanel = document.getElementById(`info-${infoType}`);
                if (infoPanel) {
                    infoPanel.classList.add('active');
                }
            }

            focusOnObject(objectName) {
                let target;
                if (objectName === 'Sun') {
                    target = this.sun;
                } else {
                    target = this.planets.find(planet => planet.name === objectName);
                }
                
                if (target) {
                    const distance = target.userData.type === 'sun' ? 100 : target.userData.distance * 2;
                    this.animateCamera(target.position, distance);
                    
                    // Update UI
                    document.querySelectorAll('.button').forEach(btn => btn.classList.remove('active'));
                    const focusBtn = document.getElementById(`focus${objectName}`);
                    if (focusBtn) {
                        focusBtn.classList.add('active');
                    }
                }
            }

            animateCamera(targetPosition, distance) {
                const startPosition = this.camera.position.clone();
                const endPosition = new THREE.Vector3(
                    targetPosition.x,
                    targetPosition.y + distance * 0.5,
                    targetPosition.z + distance
                );
                
                const startTime = performance.now();
                const duration = 2000;
                
                const animateStep = (currentTime) => {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    const easeProgress = 1 - Math.pow(1 - progress, 3);
                    
                    this.camera.position.lerpVectors(startPosition, endPosition, easeProgress);
                    this.camera.lookAt(targetPosition);
                    
                    if (progress < 1) {
                        requestAnimationFrame(animateStep);
                    }
                };
                
                requestAnimationFrame(animateStep);
            }

            onTimeSpeedChange() {
                const slider = document.getElementById('timeSpeed');
                this.timeSpeed = parseFloat(slider.value);
                document.getElementById('speedValue').textContent = this.timeSpeed.toFixed(1) + 'x';
            }

            onZoomChange() {
                const slider = document.getElementById('zoomLevel');
                const zoom = parseFloat(slider.value);
                
                if (!this.selectedPlanet) {
                    this.camera.position.setLength(zoom);
                }
            }

            togglePause() {
                this.isPaused = !this.isPaused;
                const btn = document.getElementById('pauseBtn');
                btn.textContent = this.isPaused ? '▶️ Play' : '⏸️ Pause';
                btn.classList.toggle('active', this.isPaused);
            }

            resetSimulation() {
                this.isPaused = false;
                this.timeSpeed = 1;
                this.selectedPlanet = null;
                
                // Reset camera
                this.camera.position.set(0, 100, 800);
                this.camera.lookAt(0, 0, 0);
                
                // Reset controls
                document.getElementById('timeSpeed').value = 1;
                document.getElementById('speedValue').textContent = '1.0x';
                document.getElementById('zoomLevel').value = 800;
                document.getElementById('pauseBtn').textContent = '⏸️ Pause';
                
                // Reset planet positions
                this.planets.forEach(planet => {
                    planet.userData.angle = Math.random() * Math.PI * 2;
                    planet.material.emissive.setHex(0x000000);
                });
                
                this.sun.material.emissiveIntensity = 0.5;
                
                // Show default info
                this.showPlanetInfo('default');
                
                // Clear active buttons
                document.querySelectorAll('.button').forEach(btn => btn.classList.remove('active'));
            }

            toggleOrbits() {
                this.showOrbits = !this.showOrbits;
                const btn = document.getElementById('toggleOrbits');
                btn.classList.toggle('active', this.showOrbits);
                
                this.orbitLines.forEach(orbit => {
                    orbit.visible = this.showOrbits;
                });
            }

            toggleComparison() {
                this.isComparisonMode = !this.isComparisonMode;
                const btn = document.getElementById('toggleComparison');
                const panel = document.getElementById('comparisonMode');
                
                btn.classList.toggle('active', this.isComparisonMode);
                panel.classList.toggle('active', this.isComparisonMode);
                
                if (this.isComparisonMode) {
                    this.updateComparisonData();
                }
            }

            toggleRealistic() {
                this.isRealisticMode = !this.isRealisticMode;
                const btn = document.getElementById('toggleRealistic');
                btn.classList.toggle('active', this.isRealisticMode);
                
                if (this.isRealisticMode) {
                    this.applyRealisticScaling();
                } else {
                    this.applyVisualScaling();
                }
            }

            applyRealisticScaling() {
                // Apply realistic distances and sizes (scaled down)
                this.planets.forEach((planet, index) => {
                    const data = this.planetData[index];
                    const scaleFactor = 0.01;
                    
                    planet.userData.distance = data.realDistance * scaleFactor;
                    planet.scale.setScalar(data.realSize * scaleFactor * 0.001);
                    
                    // Update orbit lines
                    if (this.orbitLines[index]) {
                        this.orbitLines[index].scale.setScalar(data.realDistance * scaleFactor);
                    }
                });
            }

            applyVisualScaling() {
                // Apply visual-friendly scaling
                this.planets.forEach((planet, index) => {
                    const data = this.planetData[index];
                    
                    planet.userData.distance = data.distance;
                    planet.scale.setScalar(1);
                    
                    // Update orbit lines
                    if (this.orbitLines[index]) {
                        this.orbitLines[index].scale.setScalar(1);
                    }
                });
            }

            updateComparisonData() {
                const comparisonData = document.getElementById('comparisonData');
                if (this.selectedPlanet && this.selectedPlanet.userData.type === 'planet') {
                    const data = this.selectedPlanet.userData.realData;
                    comparisonData.innerHTML = `
                        <p><strong>${this.selectedPlanet.name} vs Earth:</strong></p>
                        <p>Distance: ${(data.distance / 149.6).toFixed(2)}x Earth's distance</p>
                        <p>Size: ${(data.size / 12756).toFixed(2)}x Earth's diameter</p>
                        <p>Moons: ${data.moons} (Earth has 1)</p>
                    `;
                } else {
                    comparisonData.innerHTML = '<p>Select a planet to compare with Earth</p>';
                }
            }

            closeInstructions() {
                document.getElementById('instructions').style.display = 'none';
            }

            updatePlanetPositions() {
                if (this.isPaused) return;
                
                this.planets.forEach(planet => {
                    planet.userData.angle += planet.userData.speed * this.timeSpeed;
                    planet.position.x = Math.cos(planet.userData.angle) * planet.userData.distance;
                    planet.position.z = Math.sin(planet.userData.angle) * planet.userData.distance;
                    
                    // Rotate planet
                    planet.rotation.y += 0.01 * this.timeSpeed;
                    
                    // Update moon if it exists
                    const moon = planet.children.find(child => child.userData.type === 'moon');
                    if (moon) {
                        moon.userData.angle = (moon.userData.angle || 0) + moon.userData.speed * this.timeSpeed;
                        moon.position.x = Math.cos(moon.userData.angle) * 8;
                        moon.position.z = Math.sin(moon.userData.angle) * 8;
                    }
                });
            }

            updateAsteroids() {
                if (this.isPaused) return;
                
                this.asteroidBelt.forEach(asteroid => {
                    asteroid.userData.angle += asteroid.userData.speed * this.timeSpeed;
                    asteroid.position.x = Math.cos(asteroid.userData.angle) * asteroid.userData.distance;
                    asteroid.position.z = Math.sin(asteroid.userData.angle) * asteroid.userData.distance;
                    asteroid.rotation.x += 0.02 * this.timeSpeed;
                    asteroid.rotation.y += 0.01 * this.timeSpeed;
                });
            }

            updateCamera() {
                // Smooth camera rotation
                this.cameraControls.currentRotationX += (this.cameraControls.targetRotationX - this.cameraControls.currentRotationX) * 0.1;
                this.cameraControls.currentRotationY += (this.cameraControls.targetRotationY - this.cameraControls.currentRotationY) * 0.1;
                
                if (!this.selectedPlanet) {
                    const distance = this.camera.position.length();
                    this.camera.position.x = Math.cos(this.cameraControls.currentRotationY) * Math.cos(this.cameraControls.currentRotationX) * distance;
                    this.camera.position.y = Math.sin(this.cameraControls.currentRotationX) * distance;
                    this.camera.position.z = Math.sin(this.cameraControls.currentRotationY) * Math.cos(this.cameraControls.currentRotationX) * distance;
                    this.camera.lookAt(0, 0, 0);
                }
            }

            updateStats() {
                const currentTime = performance.now();
                const deltaTime = currentTime - this.lastTime;
                this.frameCount++;
                
                if (this.frameCount % 60 === 0) {
                    const fps = Math.round(1000 / deltaTime);
                    document.getElementById('fps').textContent = fps;
                    document.getElementById('objectCount').textContent = this.scene.children.length;
                    document.getElementById('cameraPos').textContent = 
                        `${this.camera.position.x.toFixed(0)}, ${this.camera.position.y.toFixed(0)}, ${this.camera.position.z.toFixed(0)}`;
                }
                
                this.lastTime = currentTime;
            }

            animate() {
                requestAnimationFrame(this.animate.bind(this));
                
                this.updatePlanetPositions();
                this.updateAsteroids();
                this.updateCamera();
                this.updateStats();
                
                if (this.particleSystem) {
                    this.particleSystem.rotation.y += 0.001;
                }
                
                this.renderer.render(this.scene, this.camera);
            }

            dispose() {
                // Clean up resources
                this.scene.traverse((object) => {
                    if (object.geometry) {
                        object.geometry.dispose();
                    }
                    if (object.material) {
                        if (Array.isArray(object.material)) {
                            object.material.forEach(material => material.dispose());
                        } else {
                            object.material.dispose();
                        }
                    }
                });
                
                this.renderer.dispose();
            }
        }

        // Initialize the simulation when the page loads
        window.addEventListener('load', () => {
            try {
                const simulation = new SolarSystemSimulation();
                
                // Handle page unload
                window.addEventListener('beforeunload', () => {
                    simulation.dispose();
                });
                
            } catch (error) {
                console.error('Failed to initialize Solar System Simulation:', error);
                document.getElementById('loading').innerHTML = 
                    '<div style="color: #ff0000;">Failed to initialize simulation. Please refresh the page.</div>';
            }
        });
    </script>
</body>
</html>